name: merge

on:
    push:
        branches:
            - main

jobs:
    publish:
        runs-on: ubuntu-latest
        if: github.repository == 'openhtc/geoipdb'
        steps:
            - name: Download artifact from ci
              uses:
                dawidd6/action-download-artifact@v11
              with:
                workflow: ci.yml
                pr: ${{ github.event.pull_request.number }}
                use_unzip: true
                path: .
                workflow_conclusion: success

            - name: Upload it to release
              env:
                GH_TOKEN: ${{ github.token }}
              run: |
                gh release upload latest city-lite.mmdb.gz --clobber
